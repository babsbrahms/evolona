<!DOCTYPE html>
<html lang="en">

<!-- Mirrored from jthemes.org/demo-admin/minton/ecommerce-add-new.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 20 Jul 2019 18:00:21 GMT -->

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <!-- Tell the browser to be responsive to screen width -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Admin Evolona">
  <meta name="author" content="Admin Evolona">
  <!-- Favicon icon -->
  <link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon">
  <title>Admin Evolona</title>
  <!-- Bootstrap Core CSS -->
  <link href="/plugins/vendors/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="/plugins/vendors/perfect-scrollbar/css/perfect-scrollbar.css" rel="stylesheet">
  <!-- This page CSS -->
  <!-- chartist CSS -->
  <link href="/plugins/vendors/morrisjs/morris.css" rel="stylesheet">
  <!--c3 CSS -->
  <link href="/plugins/vendors/c3-master/c3.min.css" rel="stylesheet">
  <!--Toaster Popup message CSS -->
  <link href="/plugins/vendors/toast-master/css/jquery.toast.css" rel="stylesheet">
  <!-- Page CSS -->
  <link href="/plugins/vendors/switchery/dist/switchery.min.css" rel="stylesheet" />
  <link rel="/stylesheet" type="text/css" href="plugins/vendors/product-slider/product-slider.css">
  <link href="/plugins/vendors/bootstrap-checkbox/awesome-bootstrap-checkbox.css" rel="stylesheet" type="text/css">
  <link href="/plugins/vendors/switchery/dist/switchery.min.css" rel="stylesheet" />
  <link href="/plugins/vendors/bootstrap-tagsinput/dist/bootstrap-tagsinput.css" rel="stylesheet" />
  <link rel="stylesheet" href="/plugins/vendors/dropify/dist/css/dropify.min.css">
  <!-- page css -->
  <link href="/assets/css/pages/file-upload.css" rel="stylesheet">
  <!-- Custom CSS -->
  <link href="/assets/css/style.css" rel="stylesheet">
  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
</head>

<body class="fix-header fix-sidebar card-no-border">
  <!-- ============================================================== -->
  <!-- Preloader - style you can find in spinners.css -->
  <!-- ============================================================== -->
  <div class="preloader">
    <div class="loader">
      <div class="loader__figure"></div>
      <p class="loader__label">Admin Evolona</p>
    </div>
  </div>
  <!-- ============================================================== -->
  <!-- Main wrapper - style you can find in pages.scss -->
  <!-- ============================================================== -->
  <div id="main-wrapper">
    <!-- ============================================================== -->
    <!-- Container1140px -->
    <!-- ============================================================== -->
    <!-- ============================================================== -->
    <!-- Topbar header - style you can find in pages.scss -->
    <!-- ============================================================== -->
    <% include ./cms/head %>
    <!-- ============================================================== -->
    <!-- End Left Sidebar - style you can find in sidebar.scss  -->
    <!-- ============================================================== -->
    <!-- ============================================================== -->
    <!-- Page wrapper  -->
    <!-- ============================================================== -->
    <div class="page-wrapper">
      <!-- ============================================================== -->
      <!-- Container fluid  -->
      <!-- ============================================================== -->
      <div class="container-fluid">
        <!-- ============================================================== -->
        <!-- Info box -->
        <!-- ============================================================== -->
        <div class="row">
          <!-- Column -->
          <div class="col-lg-12 col-md-12">
            <div class="card">
              <div class="card-body">
                <h5 class="card-title m-b-40 mt-3 align-self-center">Add new Product</h5>
                <div class="row">
                  <!-- <div class="col-lg-4 col-md-4">
                    <div class="relative">
                      <div id="amazingslider-wrapper-1" class="m-b-40">
                        <div id="amazingslider-1" style="display:block;position:relative;margin:0 auto;">
                          <ul class="amazingslider-slides" style="display:none;" >
                            <li><a href="/assets/imgs/product-imgs/a-lightbox.jpg" class="html5lightbox"><img src="/assets/imgs/product-imgs/a.jpg" alt="" title="" /></a> </li>
                            <li><a href="/assets/imgs/product-imgs/4-lightbox.jpg" class="html5lightbox"><img src="/assets/imgs/product-imgs/4.jpg" alt="" title="" /></a> </li>
                            <li><a href="/assets/imgs/product-imgs/13-lightbox.jpg" class="html5lightbox"><img src="/assets/imgs/product-imgs/13.jpg" alt="" title="" /></a> </li>
                            <li><a href="/assets/imgs/product-imgs/19-lightbox.jpg" class="html5lightbox"><img src="/assets/imgs/product-imgs/19.jpg" alt="" title="" /></a> </li>
                          </ul>
                          <ul class="amazingslider-thumbnails" style="display:none;">
                            <li><img src="/assets/imgs/product-imgs/a-tn.jpg" alt="" title="" /></li>
                            <li><img src="/assets/imgs/product-imgs/4-tn.jpg" alt="" title="" /></li>
                            <li><img src="/assets/imgs/product-imgs/13-tn.jpg" alt="" title="" /></li>
                            <li><img src="/assets/imgs/product-imgs/19-tn.jpg"  alt="" title="" /></li>
                          </ul>
                        </div>
                      </div>
                    </div>
                    <div class="upload-photo">
                      <input type="file" id="input-file-now" class="dropify" />
                    </div>
                  </div> -->
                  <!-- End of product slider -->
                  <div class="col-lg-12 col-md-12">
                    <div class="row">
                      <div class="form-wrap form-wrap2 mt-4">
                        <form class="form-horizontal" enctype="multipart/form-data" onsubmit="return sumbitForm(event)">
                          <div class="col-sm-12 col-xs-12">
                            <div class="form-group m-b-15">
                              <div class="upload-photo">
                                <input type="file" class="form-control font-14" id="input-file-now" name="pictures"
                                  required multiple accept="image/*" />
                              </div>
                            </div>
                          </div>


                          <div class="col-sm-12 col-xs-12">
                            <div class="form-group m-b-15">
                              <label class="control-label text-primary font-12 m-b-5">Product Name</label>
                              <div>
                                <input type="text" class="form-control font-14" name="name" placeholder="Name" required>
                              </div>
                            </div>
                          </div>
                          <div class="clearfix"></div>
                          <div class="form-group m-b-15">
                            <h3 class="text-center">Sizes</h3>
                            <div class="row m-0 m-b-20">
                              <div class="col-sm-6 col-xs-12">
                                <label class="control-label font-14 m-b-5">S</label>
                                <div>
                                  <input type="number" class="form-control font-14" name="S" placeholder="add quantity">
                                </div>
                              </div>

                              <div class="col-sm-6 col-xs-12">
                                <label class="control-label font-14 m-b-5">M</label>
                                <div>
                                  <input type="number" class="form-control font-14" name="M" placeholder="add quantity">
                                </div>
                              </div>

                              <div class="col-sm-6 col-xs-12">
                                <label class="control-label font-14 m-b-5">L</label>
                                <div>
                                  <input type="number" class="form-control font-14" name="L" placeholder="add quantity">
                                </div>
                              </div>

                              <div class="col-sm-6 col-xs-12">
                                <label class="control-label font-14 m-b-5">XL</label>
                                <div>
                                  <input type="number" class="form-control font-14" name="XL"
                                    placeholder="add quantity">
                                </div>
                              </div>
                              <div class="col-md-6 col-xs-12">
                                <label class="control-label font-14 m-b-5">REGULAR</label>
                                <div >
                                  <input type="number" class="form-control font-14" name="REGULAR"  placeholder="add REGULAR quantity">
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="clearfix"></div>
                          <div class="form-group m-b-15">
                            <div class="row m-0 m-b-20">
                              <div class="col-md-6 col-xs-12">
                                <label class="control-label font-14 m-b-5">Unit Price</label>
                                <div>
                                  <input type="number" class="form-control font-14 m-b-5" name="price"
                                    placeholder="Unit Price" required>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="clearfix"></div>
                          <div class="form-group m-b-15">
                            <div class="col-sm-12">
                              <label class="control-label m-b-5">Tags</label>
                              <div class="tags-default">
                                <input type="text" name="tags" data-role="tagsinput">
                              </div>
                            </div>
                          </div>
                          <div class="form-group row m-b-15">
                            <div class="col-sm-12">
                              <label class="col-12 p-t-0 m-b-5">Description</label>
                              <div class="col-12">
                                <textarea name="description" class="form-control textarea-lg"></textarea>
                              </div>
                            </div>
                          </div>
                          <div class="form-group row m-l-0 m-b-10">
                            <div class="col-md-6 col-xs-12 m-b-10">
                              <div class="p-l-15 p-r-15">
                                <!-- <input type="checkbox" checked class="js-switch" data-color="#4886ff" data-size="small" name="available" required>
                                <label class="m-l-10"> Available</label> -->
                              </div>
                            </div>
                            <div class="col-md-6  col-xs-12 text-right">
                              <div class="p-l-15 p-r-15">

                                <button type="submit"
                                  class="btn waves-effect waves-light btn-rounded btn-success">Save</button>
                                <button type="reset"
                                  class="btn btn-rounded waves-effect waves-light btn-outline-default">Cancel</button>
                              </div>
                            </div>
                          </div>
                        </form>
                        <div class="alert alert-success text-center">

                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- Column -->
    </div>
    <!-- ============================================================== -->
    <!-- End Info box -->
    <!-- chart box two -->
    <!-- ============================================================== -->
  </div>
  </div>
  <!-- ============================================================== -->
  <!-- End Page Content -->
  <!-- ============================================================== -->
  <!-- ============================================================== -->
  <!-- End Container fluid  -->
  <!-- ============================================================== -->
  <!-- ============================================================== -->
  <!-- footer -->
  <!-- ============================================================== -->
  <!-- ============================================================== -->
  <!-- End footer -->
  <!-- ============================================================== -->
  <!-- ============================================================== -->
  <!-- End Page wrapper  -->
  <!-- ============================================================== -->
  <!-- ============================================================== -->
  <!-- End Wrapper -->
  <!-- ============================================================== -->
  <!-- All Jquery -->
  <!-- ============================================================== -->
  <script src="/plugins/vendors/jquery/jquery.min.js"></script>
  <!-- Bootstrap popper Core JavaScript -->
  <script src="/plugins/vendors/bootstrap/js/popper.min.js"></script>
  <script src="/plugins/vendors/bootstrap/js/bootstrap.min.js"></script>
  <!-- slimscrollbar scrollbar JavaScript -->
  <script src="/plugins/vendors/ps/perfect-scrollbar.jquery.min.js"></script>
  <!--Wave Effects -->
  <script src="/assets/js/waves.js"></script>
  <!--Menu sidebar -->
  <script src="/assets/js/sidebarmenu.js"></script>
  <!--Custom JavaScript -->
  <script src="/assets/js/custom.min.js"></script>
  <!-- ============================================================== -->
  <!-- This page plugins -->
  <!-- ============================================================== -->
  <!--c3 JavaScript -->
  <script src="/plugins/vendors/d3/d3.min.js"></script>
  <script src="/plugins/vendors/c3-master/c3.min.js"></script>
  <!--jquery knob -->
  <script src="/plugins/vendors/knob/jquery.knob.js"></script>
  <!--Sparkline JavaScript -->
  <script src="/plugins/vendors/sparkline/jquery.sparkline.min.js"></script>
  <!--Morris JavaScript -->
  <script src="/plugins/vendors/raphael/raphael-min.js"></script>
  <script src="/plugins/vendors/morrisjs/morris.js"></script>
  <!-- Popup message jquery -->
  <script src="/plugins/vendors/toast-master/js/jquery.toast.js"></script>
  <!-- Tag input Jquery -->
  <script src="/plugins/vendors/bootstrap-tagsinput/dist/bootstrap-tagsinput.min.js"></script>
  <script src="/plugins/vendors/switchery/dist/switchery.min.js"></script>
  <script>
    $(function () {
      // Switchery
      var elems = Array.prototype.slice.call(document.querySelectorAll('.js-switch'));
      $('.js-switch').each(function () {
        new Switchery($(this)[0], $(this).data());
      });

    });
  </script>
  <!-- product jquery -->
  <script src="/plugins/vendors/product-slider/product-slider.js"></script>
  <script src="/plugins/vendors/product-slider/product-slider.init.js"></script>
  <!-- jQuery file upload -->
  <script src="/plugins/vendors/dropify/dist/js/dropify.min.js"></script>
  <script>
    $(function () {
      // Basic
      $('.dropify').dropify();

      // Translated
      $('.dropify-fr').dropify({
        messages: {
          default: 'Glissez-déposez un fichier ici ou cliquez',
          replace: 'Glissez-déposez un fichier ou cliquez pour remplacer',
          remove: 'Supprimer',
          error: 'Désolé, le fichier trop volumineux'
        }
      });

      // Used events
      var drEvent = $('#input-file-events').dropify();

      drEvent.on('dropify.beforeClear', function (event, element) {
        return confirm("Do you really want to delete \"" + element.file.name + "\" ?");
      });

      drEvent.on('dropify.afterClear', function (event, element) {
        alert('File deleted');
      });

      drEvent.on('dropify.errors', function (event, element) {
        console.log('Has Errors');
      });

      var drDestroy = $('#input-file-to-destroy').dropify();
      drDestroy = drDestroy.data('dropify')
      $('#toggleDropify').on('click', function (e) {
        e.preventDefault();
        if (drDestroy.isDropified()) {
          drDestroy.destroy();
        } else {
          drDestroy.init();
        }
      })
    });
  </script>
  <script src="https://www.gstatic.com/firebasejs/6.4.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/5.9.1/firebase-storage.js"></script>
  <script src="/js/firebase.js"></script>
  <script>
   
    alert.style.display = 'none';
    function sumbitForm(e) {
      e.preventDefault()
      // return false
      var form = document.querySelector('form');
      var alert = document.querySelector('div.alert')
      var name = form["name"].value;
      var S = form["S"].value;
      var M = form["M"].value;
      var L = form["L"].value;
      var XL = form["XL"].value;
      var REGULAR = form["REGULAR"].value;
      var tags = form["tags"].value;
      var price = form["price"].value;
      var description = form["description"].value;
      var pictures = form["pictures"];

      if (REGULAR) {
        S = 0;
        M = 0;
        L = 0;
        XL = 0;
      }

      var uploads = Array.from(pictures.files).map((item, index) => uploadImage(item, index))

      alert.innerHTML = 'Uploading images';

      Promise.all(
        // Array of "Promises"ss
        uploads
      )
        .then((url) => {
          alert.innerHTML = 'Adding product'
          uploadProduct(url)
        })
        .catch((error) => {
          alert.innerHTML = 'Error: ', error.message
          console.log(`Some failed: `, error.message)
        })

      function uploadProduct(url) {
        var xhr = new XMLHttpRequest()

        xhr.open('POST', '/cms/add-new', true)

        xhr.setRequestHeader('Content-type', 'application/json')

        xhr.onreadystatechange = function () {//Call a function when the state changes.
          if (xhr.readyState == 4 && xhr.status == 200) {
            window.location.href = '/cms/product-list'
          }
        }

        xhr.onerror = function () {
          alert.innerHTML = xhr.responseText
        }

        xhr.send(JSON.stringify({
          name, S, M, L, XL, REGULAR, tags, description, price,
          imgs: url
        }))
      }

      function uploadImage(file, index) {
        return new Promise(function (resolve, reject) {
          var ref = firebase.storage().ref().child(file.name)
          ref.put(file).then(() => {

            ref.getDownloadURL()
              .then(url => {
                alert.innerHTML = `Uploaded image ${index + 1}`
                console.log('uploaded: ', (index + 1));
                resolve(url)
              })

          }).catch((err) => {
            reject(err)
            console.log('UPLOAD ERR', err);

          })
        });
      }

    }



  </script>
  <!-- ============================================================== -->
  <!-- Style switcher -->
  <!-- ============================================================== -->
  <script src="/plugins/vendors/styleswitcher/jQuery.style.switcher.js"></script>
</body>

<!-- Mirrored from jthemes.org/demo-admin/minton/ecommerce-add-new.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 20 Jul 2019 18:00:23 GMT -->

</html>